/*--------------------------------*\
  #SITE-HEADER
\*--------------------------------*/

.site-header {
  // --- Fixed position logic ---
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 1000;
  height: $header-height;
  background-color: $color-background;
  
  // We define the properties we WANT to transition...
  transition-property: transform, opacity;
  // ...and their (new) durations...
  transition-duration: 0.3s, 0.5s; // 0.3s for transform, 0.5s for opacity
  // ...and their timing functions.
  transition-timing-function: cubic-bezier(0.25, 0.8, 0.25, 1), ease-in-out;
  // The 'transition-delay' will be set by the loader logic below.
  
  // --- Layout fix ---
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 2.5rem;
  
  // --- Overlay fix ---
  overflow: hidden; // <-- ADD THIS to clip the overlay

  border-bottom: 0.4px solid $color-neutral-300; // Adds the separation

  @media (max-width: $breakpoint-lg) {
    height: $header-height-mobile; // Sets height to 80px
  }

  &.is-hidden {
    transform: translateY(-100%);
  }
  isolation: isolate;
  // z-index: 0;
  &::after {
    // position: relative;
    // overflow-x: hidden;
    content: '';
    position: absolute;
    inset: 0;
    background-image: url("../assets/images/noise-bg.png");
    background-repeat: repeat;
    opacity: 0.25;
    z-index: -1;
    
  }
}

.fuzzy-overlay__header {
  // --- This is the fix for the overlay ---
  position: absolute;
  inset: 0; // Stretches to fill the parent header
  width: 100%;
  height: 100%;
  
  // Apply noise (using your "noise-bg.png" as per _base.scss)
  background-image: url('../assets/images/noise-bg.png');
  background-repeat: repeat;
  opacity: 0.35; // Using the opacity from your _base.scss
  
  // Put it *just* on top of the header background
  z-index: 1; 
  pointer-events: none;
  // You can add the animation back here if you want
  // animation: shift .5s linear infinite both;
}

/**
 * 1. Brand (Left Side)
 */
.site-header__brand {
  position: relative; // <-- ADD THIS
  z-index: 2;         // <-- ADD THIS
}

.site-header__brand-link {
  display: flex;
  align-items: center;
  text-decoration: none;
}

.site-header__logo {
  max-height: 64px; // Adjust as needed
  height: 10vw; // Adjust as needed
  width: auto;
  margin-right: 0.75rem;
}

.site-header__brand-text {
  font-family: $font-serif;
  font-size: 1.5rem; // 18px
  font-weight: 400;
  color: $color-text-light;
  white-space: nowrap;
}
.site-header__my-name {
    font-weight: 600;
    color: $color-brand;
    font-style: italic;
}

.site-header__my-role {
  // 1. Set as the anchor for the pseudo-element
  position: relative;
  // 2. Add padding to the bottom to make space for the line
  padding-bottom: 10px;

  &::after {
    content: '';
    position: absolute;
    
    // 3. Position the line

    top: 1.45rem;
    bottom: 0; // Sits at the very bottom of the new padding area
    left: -1rem;
    width: 100%;
    height: 3vw; // Adjust this height to match your image's aspect ratio
    max-height: 44px;

    // 4. Load the image
    background-image: url('../assets/images/pencil-underline.png');
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;

    // 5. Send it behind the text
    z-index: -1;
  }

  // 5. Responsive font size
    @media (max-width: $breakpoint-xl) {
        // display: none;
        font-size: 1rem;
    }
}

/**
 * 2. Navigation (Right Side)
 */

.site-header__nav {
  display: flex;
  align-items: center;
  position: relative; // <-- ADD THIS
  z-index: 2;  
  gap: 1rem ;

  ul {
    display: flex;
    list-style: none;
    margin: 0 1.5rem 0 0; // 24px spacing to the right
    padding: 0;
  }

  li {
    margin-left: 2rem; // 32px spacing between links
  }

  // Styles for the nav links (not the button)
  ul a {
    font-family: $font-serif;
    font-weight: 600;
    font-size: 1.25rem;
    color: $color-text;
    text-decoration: none;
    transition: color 0.2s ease;
    @include animated-underline($color-text);

    @media (max-width: $breakpoint-xl) {
      font-size: 1.125rem;
    }

    // &:hover {
    //   // color: $color-neutral-700;
    // }
  }
  a {
    font-family: $font-serif;
    font-weight: 500;
    font-size: 1.25rem;
    // font-style: italic;
  }
}

/**
 * 3. Contact Button
 * This is the final version we built.
 */
.btn-contact {
  position: relative;
  display: inline-block;
  text-decoration: none;
  font-family: $font-serif;
  font-weight: 400;
  font-size: 1.25rem;
  z-index: 10;
  padding: 1rem 2.5rem;
  transition: none; 

  // --- Red Stroke (Bottom Layer) ---
  &::before {
    content: '';
    position: absolute;
    z-index: -2;
    top: 0;
    left: 0;
    bottom: -3px;
    right: -2px;
    background-image: url('../assets/images/button-stroke-red.svg');
    background-size: 100% 100%;
    background-repeat: no-repeat;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  }

  // --- Gray Stroke (Top Layer) ---
  &::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: -1;
    background-image: url('../assets/images/button-stroke-gray.svg');
    background-size: 100% 100%;
    background-repeat: no-repeat;
  }

  // --- HOVER STATE ---
  &:hover {
    transform: none;

    &::before {
      bottom: 0;
      right: 0;
    }
  }
}

a.btn-contact {
    color: $color-button-text;
    &:hover {
      color: $color-button-text;
    }
}


/**
 * 4. Hamburger Button (Mobile Only)
 * Hidden by default on desktop.
 */
.site-header__mobile-toggle {
  display: none; // Hidden on desktop
  background: transparent;
  border: none;
  cursor: pointer;
  padding: 0.5rem;
  z-index: 1001; 

  span {
    display: block;
    width: 25px;
    height: 3px;
    background-color: $color-text;
    margin-bottom: 5px;
    transition: all 0.3s ease;
    border-radius: 2px;

    &:last-child {
      margin-bottom: 0;
    }
  }
}


/*--------------------------------*\
  #RESPONSIVE (Mobile)
\*--------------------------------*/
@media (max-width: $breakpoint-xl) {
    .site-header__brand-text {
    font-size: 1.25rem
}
}
@media (max-width: $breakpoint-lg) {

    


  .site-header {
    padding: 1rem 1.5rem; // Less padding on mobile
  }

  // Show the hamburger button
  .site-header__mobile-toggle {
    display: block;
  }

  // Hide the text part of the brand
  .site-header__brand-text {
    display: none;
  }

  // Hide the desktop nav
  .site-header__nav {
    display: none; // Hidden by default
    
    // When menu is opened
    &.is-open {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;

      // Full-screen overlay
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: $color-background;
      z-index: 1000;

      // Stack the nav links
      ul {
        flex-direction: column;
        text-align: center;
        margin: 0 0 2rem 0;
      }

      li {
        margin: 0 0 1.5rem 0;
      }

      // Make links big and tappable
      a {
        font-size: 2rem;
      }
      
      .btn-contact {
        font-size: 1.5rem;
      }
    }
  }

  // Animate the hamburger icon to an "X"
  .site-header__mobile-toggle.is-open {
    span:nth-child(1) {
      transform: translateY(8px) rotate(45deg);
    }
    span:nth-child(2) {
      opacity: 0;
    }
    span:nth-child(3) {
      transform: translateY(-8px) rotate(-45deg);
    }
  }
}